(()=>{"use strict";class t{constructor(t){this.todos=document.querySelector(".todos"),this.app=t}pushTodos(t){console.log("todos",t),this.todos.innerHTML="",t.forEach((t=>{const e=document.createElement("div"),o=document.createElement("p");o.textContent=t.title;const s=document.createElement("p");s.textContent=t.date;const d=document.createElement("button");t.completed&&d.setAttribute("disabled",!0),d.textContent="Выполнено",this.addSaveEvent(d,t.id);const n=document.createElement("button");this.addDeleteEvent(n),n.textContent="Удалить",e.appendChild(o),e.appendChild(s),e.appendChild(d),e.appendChild(n),this.todos.appendChild(e)}))}addSaveEvent(t,e){t.addEventListener("click",(()=>{this.app.changeTodo(e)}))}addDeleteEvent(t,e){t.addEventListener("click",(()=>{this.app.deleteTodo(e)}))}}class e{constructor(){this.url="http://localhost:4000/api/todos/"}getTodos(){return fetch(this.url)}postTodo(t){return fetch(this.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}patchTodo(t){return fetch(this.url,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})})}deleteTodo(t){return fetch(this.url,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})})}}const o=new class{constructor(){this.todos=[],this.render=new t(this),this.request=new e}loadTodos(){this.request.getTodos().then((t=>t.json())).then((({data:t})=>{this.todos=t,this.renderTodos(this.todos)}))}renderTodos(){this.render.pushTodos(this.todos)}addTodo(t){this.request.postTodo(t).then((t=>t.json())).then((({data:t})=>{this.todos.push(t),this.renderTodos()}))}changeTodo(t){this.request.patchTodo(t).then((t=>t.json())).then((({data:t})=>{this.todos=t,this.renderTodos()}))}deleteTodo(t){this.request.deleteTodo(t).then((t=>t.json())).then((({data:t})=>{this.todos=t,this.renderTodos()}))}},s=new class{constructor(t){this.buttonCreate=document.querySelector(".btnCreate"),this.inputTitle=document.querySelector(".title"),this.inputDate=document.querySelector(".date"),this.app=t}addListners(){this.buttonCreate.addEventListener("click",this.addTodo.bind(this))}addTodo(){const t={title:this.inputTitle.value,date:this.inputDate.value,completed:!1};this.inputTitle.value=null,this.inputDate.value=null,this.app.addTodo(t)}}(o);o.loadTodos(),s.addListners()})();